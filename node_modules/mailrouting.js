var express = require('express');
var df = require('dateformat');
var passport = require('passport');
var router = express.Router();
var mysql = require('mysql');
var cfg = require('config');
var sqlhelper = require('mysqlhelper2');
var nodemailer = require('nodemailer');

router.get("/email.html", function (req, resp) {
	var transporter = nodemailer.createTransport('smtps://'+cfg.MAIL.smtpuser+'%40gmail.com:'+cfg.MAIL.smtppassword+'@smtp.gmail.com');
	
	var mailOptions = {
	        from: "fabrice.cooren@gmail.com",
	        to: "fabrice.cooren@gmail.com",
	        subject: "Hello from nodejs",
	        text: "Hy guy, welcome to nodejs emailing test",
	        html: '<b>' + 'Hy guy, welcome to nodejs emailing test' + '</b>'
	};
	
	transporter.sendMail(mailOptions, function(error, info){
	     if(error){
	        return console.log(error);
	     }
	     console.log('Message sent: ' + info.response);
	});

	transporter.close();
});

module.exports = router;
